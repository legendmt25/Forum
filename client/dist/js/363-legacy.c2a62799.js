(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[363],{2052:function(t,n,e){"use strict";e.d(n,{Z:function(){return d}});var r=e(6252),o=e(3577),u=e(9963),a={class:"flex flex-col gap-2"},i={class:"font-bold"},c=["type","name"];function s(t,n,e,s,l,p){return(0,r.wg)(),(0,r.iD)("label",a,[(0,r._)("span",i,(0,o.zw)(p.label),1),(0,r.wy)((0,r._)("input",{type:e.type,class:"shadow-md dark:bg-neutral-600 dark:text-white form-input mt-1 block w-full rounded border",name:s.obj[e.property],"onUpdate:modelValue":n[0]||(n[0]=function(t){return s.obj[e.property]=t})},null,8,c),[[u.YZ,s.obj[e.property]]])])}var l=e(8225),p={props:{which:String,property:String,type:{type:String,default:"text"}},setup:function(t){var n=(0,r.f3)("".concat(t.which,"Data"));return{obj:n}},computed:{label:function(){return(0,l.PS)(this.property)}}},f=e(3744);const m=(0,f.Z)(p,[["render",s]]);var d=m},5347:function(t,n,e){"use strict";e.d(n,{Z:function(){return h}});var r=e(6252),o=e(3577),u=e(9963),a={class:"flex flex-col gap-2"},i={class:"text-gray-700 dark:text-white font-bold"},c=["size"],s=["value"];function l(t,n,e,l,p,f){return(0,r.wg)(),(0,r.iD)("label",a,[(0,r._)("span",i,(0,o.zw)(f.label),1),(0,r.wy)((0,r._)("select",{size:e.size,class:"form-select dark:bg-neutral-700 shadow-md border rounded w-full","onUpdate:modelValue":n[0]||(n[0]=function(t){return l.obj[e.property]=t})},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.list,(function(t,n){return(0,r.wg)(),(0,r.iD)("option",{value:t.value,key:n},(0,o.zw)(t.text),9,s)})),128))],8,c),[[u.bM,l.obj[e.property]]])])}var p=e(8225),f={props:{size:{type:String,default:"1"},which:String,property:String,list:Array},setup:function(t){var n=(0,r.f3)("".concat(t.which,"Data"));return{obj:n}},computed:{label:function(){return(0,p.PS)(this.property)}}},m=e(3744);const d=(0,m.Z)(f,[["render",l]]);var h=d},9363:function(t,n,e){"use strict";e.r(n),e.d(n,{default:function(){return I}});var r=e(6252),o=e(9963),u={class:"flex flex-col p-24 gap-10 dark:text-white"},a={class:"flex flex-col gap"},i=(0,r._)("span",{class:"font-bold"},"Post",-1);function c(t,n,e,c,s,l){var p=(0,r.up)("select-community"),f=(0,r.up)("input-component"),m=(0,r.up)("create-post-button");return(0,r.wg)(),(0,r.iD)("div",u,[(0,r.Wm)(p),(0,r.Wm)(f,{which:"post",property:"title"}),(0,r._)("label",a,[i,(0,r.wy)((0,r._)("textarea",{class:"resize-y shadow-md dark:bg-neutral-600 form-input rounded-md p-3 border","onUpdate:modelValue":n[0]||(n[0]=function(t){return c.obj.str=t})},null,512),[[o.nr,c.obj.str]])]),(0,r.Wm)(m)])}var s=e(2262),l=e(2052);function p(t,n,e,o,u,a){return(0,r.wg)(),(0,r.iD)("button",{class:"text-base px-10 py-1 shadow-sm self-end dark:bg-sky-800 hover:dark:bg-sky-700 bg-blue-500 rounded-full hover:bg-blue-400 transition-all font-bold text-white",onClick:n[0]||(n[0]=function(t){return a.createPost()})}," Create ")}var f=e(8534),m=(e(5666),e(1539),e(8862),e(1703),{setup:function(){var t=(0,r.f3)("postData"),n=(0,r.f3)("communityData");return{obj:t,community:n}},methods:{createPost:function(){var t=this;return(0,f.Z)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,fetch("http://localhost:3000/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:"\n            mutation CREATE_POST($userId: String!, $communityId: String!, $postInput: PostInput!) {\n                createPost(userId: $userId, communityId: $communityId, postInput: $postInput) {\n                    id\n                    title\n                    createdAt\n                    user {\n                    id\n                    username\n                    email\n                    }\n                    comments{\n                    id\n                    text\n                    }\n                }\n            }\n            ",variables:{userId:JSON.parse(sessionStorage.getItem("user")).id,communityId:t.community.community,postInput:{title:t.obj.title,str:t.obj.str}}})}).then((function(t){return t.json()})).then((function(n){if(null==n.data)throw Error("You cant create a post at this moment. Try again later");return t.$router.push("/community/".concat(t.community.community)),n.data.createPost})).catch((function(t){throw t}));case 3:n.next=8;break;case 5:n.prev=5,n.t0=n["catch"](0),alert(n.t0);case 8:case"end":return n.stop()}}),n,null,[[0,5]])})))()}}}),d=e(3744);const h=(0,d.Z)(m,[["render",p]]);var y=h;function b(t,n,e,o,u,a){var i=(0,r.up)("select-component");return(0,r.wg)(),(0,r.j4)(i,{which:"community",property:"community",list:u.authUserCommunities},null,8,["list"])}var v=e(5347),g=e(8225),w={data:function(){return{authUserCommunities:[]}},components:{SelectComponent:v.Z},created:function(){var t=this;return(0,f.Z)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,fetch("http://localhost:3000/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:"\n          query GET_USER_COMMUNITIES($userId: String!) {\n            user(userId: $userId) {\n              communities {\n                id\n                name\n              }\n            }\n          }",variables:{userId:JSON.parse(sessionStorage.getItem("user")).id}})}).then((function(t){return t.json()})).then((function(t){if(null==t.data)throw Error("User not found");return t.data.user.communities})).catch((function(t){throw t}));case 3:t.authUserCommunities=n.sent,t.authUserCommunities=(0,g.ET)(t.authUserCommunities,"name","id"),n.next=10;break;case 7:n.prev=7,n.t0=n["catch"](0),console.log(n.t0);case 10:case"end":return n.stop()}}),n,null,[[0,7]])})))()}};const x=(0,d.Z)(w,[["render",b]]);var k=x,S={name:"createPostView",setup:function(){var t=(0,s.iH)({title:"",str:""}),n=(0,s.iH)({community:""});(0,r.JJ)("communityData",n),(0,r.JJ)("postData",t);var e=(0,r.f3)("authenticated");return{obj:t,isAuthenticated:e,community:n}},components:{InputComponent:l.Z,createPostButton:y,SelectCommunity:k}};const E=(0,d.Z)(S,[["render",c]]);var I=E},2914:function(t,n,e){var r=e(7293),o=e(9114);t.exports=!r((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",o(1,7)),7!==t.stack)}))},8340:function(t,n,e){var r=e(111),o=e(8880);t.exports=function(t,n){r(n)&&"cause"in n&&o(t,"cause",n.cause)}},9191:function(t,n,e){"use strict";var r=e(5005),o=e(2597),u=e(8880),a=e(7976),i=e(7674),c=e(9920),s=e(9587),l=e(6277),p=e(8340),f=e(7741),m=e(2914),d=e(1913);t.exports=function(t,n,e,h){var y=h?2:1,b=t.split("."),v=b[b.length-1],g=r.apply(null,b);if(g){var w=g.prototype;if(!d&&o(w,"cause")&&delete w.cause,!e)return g;var x=r("Error"),k=n((function(t,n){var e=l(h?n:t,void 0),r=h?new g(t):new g;return void 0!==e&&u(r,"message",e),m&&u(r,"stack",f(r.stack,2)),this&&a(w,this)&&s(r,this,k),arguments.length>y&&p(r,arguments[y]),r}));if(k.prototype=w,"Error"!==v&&(i?i(k,x):c(k,x,{name:!0})),c(k,g),!d)try{w.name!==v&&u(w,"name",v),w.constructor=k}catch(S){}return k}}},1703:function(t,n,e){var r=e(2109),o=e(7854),u=e(2104),a=e(9191),i="WebAssembly",c=o[i],s=7!==Error("e",{cause:7}).cause,l=function(t,n){var e={};e[t]=a(t,n,s),r({global:!0,forced:s},e)},p=function(t,n){if(c&&c[t]){var e={};e[t]=a(i+"."+t,n,s),r({target:i,stat:!0,forced:s},e)}};l("Error",(function(t){return function(n){return u(t,this,arguments)}})),l("EvalError",(function(t){return function(n){return u(t,this,arguments)}})),l("RangeError",(function(t){return function(n){return u(t,this,arguments)}})),l("ReferenceError",(function(t){return function(n){return u(t,this,arguments)}})),l("SyntaxError",(function(t){return function(n){return u(t,this,arguments)}})),l("TypeError",(function(t){return function(n){return u(t,this,arguments)}})),l("URIError",(function(t){return function(n){return u(t,this,arguments)}})),p("CompileError",(function(t){return function(n){return u(t,this,arguments)}})),p("LinkError",(function(t){return function(n){return u(t,this,arguments)}})),p("RuntimeError",(function(t){return function(n){return u(t,this,arguments)}}))}}]);
//# sourceMappingURL=363-legacy.c2a62799.js.map