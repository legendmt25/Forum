(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[363],{2052:function(t,e,n){"use strict";n.d(e,{Z:function(){return f}});var r=n(6252),o=n(3577),u=n(9963);const s={class:"flex flex-col gap-2"},i={class:"font-bold"},a=["type","name"];function c(t,e,n,c,l,p){return(0,r.wg)(),(0,r.iD)("label",s,[(0,r._)("span",i,(0,o.zw)(p.label),1),(0,r.wy)((0,r._)("input",{type:n.type,class:"shadow-md dark:bg-neutral-600 dark:text-white form-input mt-1 block w-full rounded border",name:c.obj[n.property],"onUpdate:modelValue":e[0]||(e[0]=t=>c.obj[n.property]=t)},null,8,a),[[u.YZ,c.obj[n.property]]])])}var l=n(8225),p={props:{which:String,property:String,type:{type:String,default:"text"}},setup(t){const e=(0,r.f3)(`${t.which}Data`);return{obj:e}},computed:{label(){return(0,l.PS)(this.property)}}},m=n(3744);const d=(0,m.Z)(p,[["render",c]]);var f=d},5347:function(t,e,n){"use strict";n.d(e,{Z:function(){return h}});var r=n(6252),o=n(3577),u=n(9963);const s={class:"flex flex-col gap-2"},i={class:"text-gray-700 dark:text-white font-bold"},a=["size"],c=["value"];function l(t,e,n,l,p,m){return(0,r.wg)(),(0,r.iD)("label",s,[(0,r._)("span",i,(0,o.zw)(m.label),1),(0,r.wy)((0,r._)("select",{size:n.size,class:"form-select dark:bg-neutral-700 shadow-md border rounded w-full","onUpdate:modelValue":e[0]||(e[0]=t=>l.obj[n.property]=t)},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(n.list,((t,e)=>((0,r.wg)(),(0,r.iD)("option",{value:t.value,key:e},(0,o.zw)(t.text),9,c)))),128))],8,a),[[u.bM,l.obj[n.property]]])])}var p=n(8225),m={props:{size:{type:String,default:"1"},which:String,property:String,list:Array},setup(t){const e=(0,r.f3)(`${t.which}Data`);return{obj:e}},computed:{label(){return(0,p.PS)(this.property)}}},d=n(3744);const f=(0,d.Z)(m,[["render",l]]);var h=f},9363:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return E}});var r=n(6252),o=n(9963);const u={class:"flex flex-col p-24 gap-10 dark:text-white"},s={class:"flex flex-col gap"},i=(0,r._)("span",{class:"font-bold"},"Post",-1);function a(t,e,n,a,c,l){const p=(0,r.up)("select-community"),m=(0,r.up)("input-component"),d=(0,r.up)("create-post-button");return(0,r.wg)(),(0,r.iD)("div",u,[(0,r.Wm)(p),(0,r.Wm)(m,{which:"post",property:"title"}),(0,r._)("label",s,[i,(0,r.wy)((0,r._)("textarea",{class:"resize-y shadow-md dark:bg-neutral-600 form-input rounded-md p-3 border","onUpdate:modelValue":e[0]||(e[0]=t=>a.obj.str=t)},null,512),[[o.nr,a.obj.str]])]),(0,r.Wm)(d)])}var c=n(2262),l=n(2052);function p(t,e,n,o,u,s){return(0,r.wg)(),(0,r.iD)("button",{class:"text-base px-10 py-1 shadow-sm self-end dark:bg-sky-800 hover:dark:bg-sky-700 bg-blue-500 rounded-full hover:bg-blue-400 transition-all font-bold text-white",onClick:e[0]||(e[0]=t=>s.createPost())}," Create ")}n(1703);var m={setup(){const t=(0,r.f3)("postData"),e=(0,r.f3)("communityData");return{obj:t,community:e}},methods:{async createPost(){try{await fetch("http://localhost:3000/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:"\n            mutation CREATE_POST($userId: String!, $communityId: String!, $postInput: PostInput!) {\n                createPost(userId: $userId, communityId: $communityId, postInput: $postInput) {\n                    id\n                    title\n                    createdAt\n                    user {\n                    id\n                    username\n                    email\n                    }\n                    comments{\n                    id\n                    text\n                    }\n                }\n            }\n            ",variables:{userId:JSON.parse(sessionStorage.getItem("user")).id,communityId:this.community.community,postInput:{title:this.obj.title,str:this.obj.str}}})}).then((t=>t.json())).then((t=>{if(null==t.data)throw Error("You cant create a post at this moment. Try again later");return this.$router.push(`/community/${this.community.community}`),t.data.createPost})).catch((t=>{throw t}))}catch(t){alert(t)}}}},d=n(3744);const f=(0,d.Z)(m,[["render",p]]);var h=f;function y(t,e,n,o,u,s){const i=(0,r.up)("select-component");return(0,r.wg)(),(0,r.j4)(i,{which:"community",property:"community",list:u.authUserCommunities},null,8,["list"])}var b=n(5347),g=n(8225),w={data(){return{authUserCommunities:[]}},components:{SelectComponent:b.Z},async created(){try{this.authUserCommunities=await fetch("http://localhost:3000/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:"\n          query GET_USER_COMMUNITIES($userId: String!) {\n            user(userId: $userId) {\n              communities {\n                id\n                name\n              }\n            }\n          }",variables:{userId:JSON.parse(sessionStorage.getItem("user")).id}})}).then((t=>t.json())).then((t=>{if(null==t.data)throw Error("User not found");return t.data.user.communities})).catch((t=>{throw t})),this.authUserCommunities=(0,g.ET)(this.authUserCommunities,"name","id")}catch(t){console.log(t)}}};const v=(0,d.Z)(w,[["render",y]]);var S=v,x={name:"createPostView",setup(){let t=(0,c.iH)({title:"",str:""}),e=(0,c.iH)({community:""});(0,r.JJ)("communityData",e),(0,r.JJ)("postData",t);let n=(0,r.f3)("authenticated");return{obj:t,isAuthenticated:n,community:e}},components:{InputComponent:l.Z,createPostButton:h,SelectCommunity:S}};const k=(0,d.Z)(x,[["render",a]]);var E=k},2914:function(t,e,n){var r=n(7293),o=n(9114);t.exports=!r((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",o(1,7)),7!==t.stack)}))},2104:function(t,e,n){var r=n(4374),o=Function.prototype,u=o.apply,s=o.call;t.exports="object"==typeof Reflect&&Reflect.apply||(r?s.bind(u):function(){return s.apply(u,arguments)})},8340:function(t,e,n){var r=n(111),o=n(8880);t.exports=function(t,e){r(e)&&"cause"in e&&o(t,"cause",e.cause)}},9191:function(t,e,n){"use strict";var r=n(5005),o=n(2597),u=n(8880),s=n(7976),i=n(7674),a=n(9920),c=n(9587),l=n(6277),p=n(8340),m=n(7741),d=n(2914),f=n(1913);t.exports=function(t,e,n,h){var y=h?2:1,b=t.split("."),g=b[b.length-1],w=r.apply(null,b);if(w){var v=w.prototype;if(!f&&o(v,"cause")&&delete v.cause,!n)return w;var S=r("Error"),x=e((function(t,e){var n=l(h?e:t,void 0),r=h?new w(t):new w;return void 0!==n&&u(r,"message",n),d&&u(r,"stack",m(r.stack,2)),this&&s(v,this)&&c(r,this,x),arguments.length>y&&p(r,arguments[y]),r}));if(x.prototype=v,"Error"!==g&&(i?i(x,S):a(x,S,{name:!0})),a(x,w),!f)try{v.name!==g&&u(v,"name",g),v.constructor=x}catch(k){}return x}}},1703:function(t,e,n){var r=n(2109),o=n(7854),u=n(2104),s=n(9191),i="WebAssembly",a=o[i],c=7!==Error("e",{cause:7}).cause,l=function(t,e){var n={};n[t]=s(t,e,c),r({global:!0,forced:c},n)},p=function(t,e){if(a&&a[t]){var n={};n[t]=s(i+"."+t,e,c),r({target:i,stat:!0,forced:c},n)}};l("Error",(function(t){return function(e){return u(t,this,arguments)}})),l("EvalError",(function(t){return function(e){return u(t,this,arguments)}})),l("RangeError",(function(t){return function(e){return u(t,this,arguments)}})),l("ReferenceError",(function(t){return function(e){return u(t,this,arguments)}})),l("SyntaxError",(function(t){return function(e){return u(t,this,arguments)}})),l("TypeError",(function(t){return function(e){return u(t,this,arguments)}})),l("URIError",(function(t){return function(e){return u(t,this,arguments)}})),p("CompileError",(function(t){return function(e){return u(t,this,arguments)}})),p("LinkError",(function(t){return function(e){return u(t,this,arguments)}})),p("RuntimeError",(function(t){return function(e){return u(t,this,arguments)}}))}}]);
//# sourceMappingURL=363.c850ac80.js.map